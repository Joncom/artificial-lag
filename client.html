<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <script src="http://localhost:3000/socket.io/socket.io.js"></script>
    <script>
        function init() {
            var socket = io('http://localhost:3000');
            socket.on('connect', function() {
                console.log('Connected');

                // Hi-jack the emit function and add delay.
                var emit_orig = socket.emit;
                var delay = 50;
                socket.emit = function() {
                    var args = arguments;
                    setTimeout(function() {
                        emit_orig.apply(socket, args);
                    }, delay);
                };

                socket.on('ping', function() {
                    socket.emit('pong');
                });

                socket.on('disconnect', function() {
                    console.log('Disconnected');
                });
            });
        }
    </script>
</head>
<body onload="init();">
</body>
</html>